<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title data-i18n="title">æ™ºæ…§è·¯ç‰Œ</title>
  <!-- å¼•å…¥ CSS èˆ‡ manifest -->
  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="manifest.json" />
</head>

<body id="mode-controller" data-mode="guide">
  <div id="guide-mode">

    <!-- é é¦–ï¼šèªè¨€åˆ‡æ› -->
    <header>
      <div class="language-container">
        <select id="language-selector">
          <option value="zh">ä¸­æ–‡</option>
          <option value="en">English</option>
        </select>
      </div>
    </header>

    <!-- é¡¯ç¤ºç›®å‰æ™‚é–“ -->
    <div id="time-display" class="large-clock">
  <span id="time">--:--:--</span>
    </div>

    <!-- é¦–é æŒ‰éˆ• -->
    <div id="main-buttons" class="button-container">
      <button onclick="openClassroomGuide()">ğŸ« æ•™å®¤å°å¼•</button>
      <button onclick="showOtherFunctions()">ğŸ”§ å…¶ä»–åŠŸèƒ½</button>
    </div>

   <!-- ç¬¬äºŒå±¤æŒ‰éˆ•å€ï¼ˆå…¶ä»–åŠŸèƒ½ï¼‰ -->
  <div id="secondary-buttons" class="button-container" style="display: none;">
  <button onclick="openWeather()">ğŸŒ¤ å¤©æ°£æŸ¥è©¢</button>
  <button onclick="openMap()">ğŸ—º ç¾é£Ÿåœ°åœ–</button>
  <button onclick="openCampusInfo()">ğŸ« æ ¡å€ä»‹ç´¹</button>
  <button onclick="openBusInfo()">ğŸšŒ å…¬è»Šç«™ç‰Œ</button>
  <button onclick="openMRT()">ğŸš‡ æ·é‹ç«™</button>
  <button onclick="openYoubike()">ğŸš´ YouBike</button>
  <button onclick="openFoodWheel()">ğŸ² ç¾é£Ÿè½‰ç›¤</button>
  <button onclick="openNews()">ğŸ“° æœ€æ–°è³‡è¨Š</button>
</div>

<!-- ä¸Šä¸€é æŒ‰éˆ• -->
<div id="back-button" style="text-align: right; margin: 10px; display: none;">
  <button onclick="goBack()">â¬…ï¸ ä¸Šä¸€é </button>
</div>



    <!-- å¤©æ°£æŸ¥è©¢å€å¡Š -->
    <div class="weather-container">
      <div id="weatherBox" class="weather-form" style="display: none;">
        <h3>ğŸ” å¤©æ°£æŸ¥è©¢</h3>
        <label for="city">é¸æ“‡ç¸£å¸‚:</label>
        <select id="city">
          <option value="">è«‹é¸æ“‡ç¸£å¸‚</option>
        </select>
        <button id="submitWeather">ğŸ“¡ æŸ¥è©¢å¤©æ°£</button>
        <button id="closeWeather" class="close-btn">âŒ é—œé–‰æŸ¥è©¢</button>
      </div>
      <div id="output" class="weather-output"></div>
    </div>

    <!-- æ•™å®¤å°å¼•å€å¡Š -->
    <div id="classroomBox" class="container" style="display: none;">
      <select id="area" onchange="updateClassrooms()">
        <option value="">è«‹é¸æ“‡å€åŸŸ</option>
        <option value="cheng">èª </option>
        <option value="zheng">æ­£</option>
        <option value="qin">å‹¤</option>
        <option value="pu">æ¨¸</option>
      </select>
      <select id="floor" onchange="updateClassrooms()">
        <option value="">è«‹é¸æ“‡æ¨“å±¤</option>
      </select>
      <select id="classroom">
        <option value="">è«‹é¸æ“‡æ•™å®¤</option>
      </select>
      <button onclick="showImage()">é¡¯ç¤ºåœ–ç‰‡</button>

      <div id="weatherDisplay">
        <div id="result" style="display: none;">
          <img id="classroom-image" src="" alt="æ•™å®¤åœ–ç‰‡" />
        </div>
      </div>

      <button onclick="goHome()">â¬…ï¸ è¿”å›é¦–é </button>
    </div>

    <!-- å°åŠ©æ‰‹æŒ‰éˆ• -->
    <div id="ai-assistant" class="assistant-button">
      <button onclick="showMenu()">å°åŠ©æ‰‹</button>
    </div>

    <!-- å°åŠ©æ‰‹åŠŸèƒ½é¸å–® -->
    <div id="menu" class="assistant-menu">
      <button onclick="showAnswer('weather')">ğŸŒ¦ å¦‚ä½•æŸ¥è©¢å¤©æ°£ï¼Ÿ</button>
      <button onclick="showAnswer('youbike')">ğŸš´â€â™€ï¸ å¦‚ä½•æŸ¥è©¢é™„è¿‘çš„ YouBike ç«™é»ï¼Ÿ</button>
      <button onclick="showAnswer('map')">ğŸ§­ å¦‚ä½•ä½¿ç”¨åœ°åœ–å°èˆªï¼Ÿ</button>
      <button onclick="showAnswer('services')">ğŸ”§ å…¶ä»–æœå‹™æœ‰å“ªäº›åŠŸèƒ½ï¼Ÿ</button>
      <button onclick="showAnswer('foodWheel')">ğŸ½ ç¾é£Ÿè½‰ç›¤è¦æ€éº¼ä½¿ç”¨ï¼Ÿ</button>
      <button onclick="showAnswer('sosMode')">ğŸš¨ å¦‚ä½•é–‹å•Ÿç·Šæ€¥æ¨¡å¼ï¼Ÿ</button>
      <button onclick="showAnswer('howToStart')">ğŸ–± é¦–æ¬¡ä½¿ç”¨è©²å¾å“ªè£¡é–‹å§‹ï¼Ÿ</button>
      <button onclick="showAnswer('returnHome')">ğŸ  ä½¿ç”¨å¾Œå¦‚ä½•è¿”å›ä¸»ç•«é¢ï¼Ÿ</button>
      <button onclick="showAnswer('soundOff')">ğŸ”‡ ç‚ºä»€éº¼æ²’æœ‰è½åˆ°è­¦å ±è²ï¼Ÿ</button>
      <button onclick="showAnswer('foodWheelCriteria')">ğŸ´ ç¾é£Ÿè½‰ç›¤æ˜¯å¦‚ä½•æ±ºå®šæ¨è–¦é¤å»³çš„ï¼Ÿ</button>  
      <button onclick="closeMenu()">âŒ é—œé–‰é¸å–®</button>    
    </div>

    <!-- å°åŠ©æ‰‹ç­”è¦†å€ -->
    <div id="answer" class="assistant-answer">
      <p id="answer-text"></p>
      <button onclick="closeAnswer()">é—œé–‰</button>
    </div>

    <!-- å¼•å…¥ JavaScript -->
    <script src="wheather.js"></script>
    <script src="ad.js"></script>
    <script src="otherfunction.js"></script>
    <script src="map.js"></script>
    <script src="classroom.js"></script>
    <script src="utils.js"></script>

    <script>
      // è¿”å›é¦–é åŠŸèƒ½
      function goHome() {
        document.getElementById("dm-container").style.display = "block";
        document.getElementById("output").innerHTML = "";
        document.getElementById("weatherBox").style.display = "none";
        document.getElementById("classroomBox").style.display = "none";
        document.getElementById("result").style.display = "none";
      }

      // é¡¯ç¤ºå¤©æ°£æŸ¥è©¢å€å¡Š
      function openWeather() {
        closeAllFeatureBoxes();
        document.getElementById("dm-container").style.display = "none";
        document.getElementById("weatherBox").style.display = "block";
      }

      // è¨»å†Š PWA çš„ Service Worker
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("service-worker.js")
          .then(() => console.log("Service Worker è¨»å†ŠæˆåŠŸ"))
          .catch((error) => console.log("Service Worker è¨»å†Šå¤±æ•—:", error));
      }

      // èªè¨€è¼‰å…¥
      async function loadLanguage(lang) {
        const res = await fetch('languages.json');
        const data = await res.json();
        const translations = data[lang];
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.getAttribute('data-i18n');
          if (translations[key]) {
            el.textContent = translations[key];
          }
        });
      }

      document.getElementById('language-selector').addEventListener('change', e => {
        loadLanguage(e.target.value);
      });

      // é è¨­èªè¨€ç‚ºä¸­æ–‡
      loadLanguage('zh');

      // æ•™å®¤å°å¼•åˆ‡æ›
      function toggleClassroomGuide() {
        const box = document.getElementById("classroomBox");
        box.style.display = box.style.display === "none" ? "block" : "none";
      }

      // å³æ™‚æ›´æ–°æ™‚é–“
      function updateTime() {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        document.getElementById("time").textContent = `${hours}:${minutes}:${seconds}`;
      }
      setInterval(updateTime, 1000);
      updateTime();
    </script>

    <!-- å‹•æ…‹æœå‹™å€å®¹å™¨ -->
    <div id="serviceContainer"></div>

    <!-- é–’ç½®ç•«é¢ï¼šæŠ•å½±ç‰‡æ’­æ”¾å€ -->
    <div id="screensaver" style="display: none;">
      <div class="slideshow">   
        <img src="images/é˜²ç½é¿é›£æµç¨‹.jpg" class="slide" />
        <img src="images/é€ƒç”Ÿé¿é›£åœ–.jpg" class="slide" />
        <img src="images/å¸«å¤§é€£çµå­¸æ ¡.jpg" class="slide" />
        <img src="images/å¸«å¤§ç™¾å¹´.jpg" class="slide" />
        <img src="images/æ¶ˆé˜²å®‰å…¨.jpg" class="slide" />
      </div>
    </div>
  </div>

  <!-- åœ–ç‰‡æ”¾å¤§é¡¯ç¤º Modal -->
  <div id="imageModal" class="modal" onclick="closeModal()" style="display:none;">
    <span class="modal-close">&times;</span>
    <img class="modal-content" id="modalImage">
  </div>
<div id="fullscreen-box" class="fullscreen-box" style="display: none;"></div>
</body>
</html>
