<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title data-i18n="title">æ™ºæ…§è·¯ç‰Œ</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="manifest.json" />
</head>

<body id="mode-controller" data-mode="guide">
  <div id="guide-mode">
    <header>
      <div class="language-container">
        <select id="language-selector">
          <option value="zh">ä¸­æ–‡</option>
          <option value="en">English</option>
        </select>
      </div>
    </header>

    <h1 id="homepage" data-i18n="description">æ™ºæ…§è·¯ç‰Œç³»çµ±</h1>

    <!-- é¡¯ç¤ºä¸­åŸæ¨™æº–æ™‚é–“ -->
    <div id="time-display">
      <span id="time">--:--:--</span>
    </div>

    <div class="button-container">
      <button id="weather" onclick="openWeather()" data-i18n="weather">ğŸŒ¤ å¤©æ°£æŸ¥è©¢</button>
      <button id="map" onclick="openMap()" data-i18n="map">ğŸ—º åœ°åœ–å°èˆª</button>
      <button onclick="openClassroomGuide()">ğŸ« æ•™å®¤å°å¼•</button>
      <button id="services" onclick="otherServices()" data-i18n="services">ğŸ”§ å…¶ä»–æœå‹™</button>
    </div>

    <div class="weather-container">
      <div id="weatherBox" class="weather-form" style="display: none;">
        <h3>ğŸ” å¤©æ°£æŸ¥è©¢</h3>
        <label for="city">é¸æ“‡ç¸£å¸‚:</label>
        <select id="city">
          <option value="">è«‹é¸æ“‡ç¸£å¸‚</option>
        </select>
        <button id="submitWeather">ğŸ“¡ æŸ¥è©¢å¤©æ°£</button>
        <button id="closeWeather" class="close-btn">âŒ é—œé–‰æŸ¥è©¢</button>
      </div>
      <div id="output" class="weather-output"></div>
    </div>

    <div id="classroomBox" class="container" style="display: none;">
      <select id="area" onchange="updateClassrooms()">
        <option value="">è«‹é¸æ“‡å€åŸŸ</option>
        <option value="cheng">èª </option>
        <option value="zheng">æ­£</option>
        <option value="qin">å‹¤</option>
        <option value="pu">æ¨¸</option>
      </select>
      <select id="floor" onchange="updateClassrooms()">
        <option value="">è«‹é¸æ“‡æ¨“å±¤</option>
      </select>
      <select id="classroom">
        <option value="">è«‹é¸æ“‡æ•™å®¤</option>
      </select>
      <button onclick="showImage()">é¡¯ç¤ºåœ–ç‰‡</button>
      <div id="weatherDisplay">
        <div id="result" style="display: none;">
          <img id="classroom-image" src="" alt="æ•™å®¤åœ–ç‰‡" />
        </div>
      </div>
      <button onclick="goHome()">â¬…ï¸ è¿”å›é¦–é </button>
    </div>

    <div id="ai-assistant" class="assistant-button">
      <button onclick="showMenu()">å°åŠ©æ‰‹</button>
    </div>

    <div id="menu" class="assistant-menu">
      <button onclick="showAnswer('weather')">ğŸŒ¦ å¦‚ä½•æŸ¥è©¢å¤©æ°£ï¼Ÿ</button>
      <button onclick="showAnswer('youbike')">ğŸš´â€â™€ï¸ å¦‚ä½•æŸ¥è©¢é™„è¿‘çš„ YouBike ç«™é»ï¼Ÿ</button>
      <button onclick="showAnswer('map')">ğŸ§­ å¦‚ä½•ä½¿ç”¨åœ°åœ–å°èˆªï¼Ÿ</button>
      <button onclick="showAnswer('services')">ğŸ”§ å…¶ä»–æœå‹™æœ‰å“ªäº›åŠŸèƒ½ï¼Ÿ</button>
      <button onclick="showAnswer('foodWheel')">ğŸ½ ç¾é£Ÿè½‰ç›¤è¦æ€éº¼ä½¿ç”¨ï¼Ÿ</button>
      <button onclick="showAnswer('sosMode')">ğŸš¨ å¦‚ä½•é–‹å•Ÿç·Šæ€¥æ¨¡å¼ï¼Ÿ</button>
      <button onclick="showAnswer('howToStart')">ğŸ–± é¦–æ¬¡ä½¿ç”¨è©²å¾å“ªè£¡é–‹å§‹ï¼Ÿ</button>
      <button onclick="showAnswer('returnHome')">ğŸ  ä½¿ç”¨å¾Œå¦‚ä½•è¿”å›ä¸»ç•«é¢ï¼Ÿ</button>
      <button onclick="showAnswer('soundOff')">ğŸ”‡ ç‚ºä»€éº¼æ²’æœ‰è½åˆ°è­¦å ±è²ï¼Ÿ</button>
      <button onclick="showAnswer('foodWheelCriteria')">ğŸ´ ç¾é£Ÿè½‰ç›¤æ˜¯å¦‚ä½•æ±ºå®šæ¨è–¦é¤å»³çš„ï¼Ÿ</button>  
      <button onclick="closeMenu()">âŒ é—œé–‰é¸å–®</button>    
    </div>

    <div id="answer" class="assistant-answer">
      <p id="answer-text"></p>
      <button onclick="closeAnswer()">é—œé–‰</button>
    </div>

    <script src="script.js"></script>
    <script src="otherfunction.js"></script>
    <script src="map.js"></script>
    <script src="classroom.js"></script>
    <script src="utils.js"></script>
    <script>
      function goHome() {
        document.getElementById("dm-container").style.display = "block";
        document.getElementById("output").innerHTML = "";
        document.getElementById("weatherBox").style.display = "none";
        document.getElementById("classroomBox").style.display = "none";
        document.getElementById("result").style.display = "none";
      }

      function openWeather() {
        closeAllFeatureBoxes();
        document.getElementById("dm-container").style.display = "none";
        document.getElementById("weatherBox").style.display = "block";
      }

      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("service-worker.js")
          .then(() => console.log("Service Worker è¨»å†ŠæˆåŠŸ"))
          .catch((error) => console.log("Service Worker è¨»å†Šå¤±æ•—:", error));
      }

      async function loadLanguage(lang) {
        const res = await fetch('languages.json');
        const data = await res.json();
        const translations = data[lang];
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.getAttribute('data-i18n');
          if (translations[key]) {
            el.textContent = translations[key];
          }
        });
      }

      document.getElementById('language-selector').addEventListener('change', e => {
        loadLanguage(e.target.value);
      });

      loadLanguage('zh');

      function toggleClassroomGuide() {
        const box = document.getElementById("classroomBox");
        box.style.display = box.style.display === "none" ? "block" : "none";
      }

      // é¡¯ç¤ºæ™‚é–“
      function updateTime() {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        document.getElementById("time").textContent = `${hours}:${minutes}:${seconds}`;
      }
      setInterval(updateTime, 1000);
      updateTime();
    </script>
    <div id="serviceContainer"></div>

    <!-- é–’ç½®å¾…æ©ŸæŠ•å½±ç‰‡ -->
    <div id="screensaver" style="display: none;">
      <div class="slideshow">   
        <img src="images/é˜²ç½é¿é›£æµç¨‹.jpg" class="slide" />
        <img src="images/é€ƒç”Ÿé¿é›£åœ–.jpg" class="slide" />
        <img src="images/å¸«å¤§é€£çµå­¸æ ¡.jpg" class="slide" />
        <img src="images/å¸«å¤§ç™¾å¹´.jpg" class="slide" />
        <img src="images/æ¶ˆé˜²å®‰å…¨.jpg" class="slide" />
      </div>
    </div>
  </div>
</body>

</html>
